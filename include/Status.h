//
// Created by 神奇bug在哪里 on 7/16/23.
//

#ifndef SEARCHCAR_STATUS_H
#define SEARCHCAR_STATUS_H
#include <Arduino.h>
extern uint64_t status;
/// 系统全局的状态，是否开始运行。
#define STATUS_RUNNING_MASK 0x0000000000000001
#define STATUS_RUNNING 0x0000000000000001
#define STATUS_STOP 0x0000000000000000

/// 指定系统是否已经完成对地图（邻接矩阵）的建立。
#define STATUS_MAP_BUILD_MASK 0x0000000000000002
#define STATUS_MAP_BUILD 0x0000000000000002
#define STATUS_MAP_NOT_BUILD 0x0000000000000000

/// 指定系统当前是否处于自动探索模式。
#define STATUS_AUTO_SEARCH_MASK 0x0000000000000004
#define STATUS_AUTO_SEARCH 0x0000000000000004
#define STATUS_NOT_AUTO_SEARCH 0x0000000000000000

/// 指定系统当前是否处于探索完成后的自动寻找目标模式。
#define STATUS_AUTO_FIND_TARGET_MASK 0x0000000000000008
#define STATUS_AUTO_FIND_TARGET 0x0000000000000008
#define STATUS_NOT_AUTO_FIND_TARGET 0x0000000000000000

/// 指定系统当前是否处于手动控制模式。
#define STATUS_MANUAL_CONTROL_MASK 0x0000000000000010
#define STATUS_MANUAL_CONTROL 0x0000000000000010
#define STATUS_NOT_MANUAL_CONTROL 0x0000000000000000

/// 指定系统当前准备前往的目标点，整个地图点的编号从0开始，最大编号为6x6的地图，且地图可活动区域为5x5加上入口和出口，即总编号数为27
#define STATUS_TARGET_MASK 0x00000000000003E0
#define STATUS_TARGET_OFFSET 5
#define STATUS_TARGET(x) ((uint64_t)(x) << STATUS_TARGET_OFFSET)

/// 系统是否已经到达目标点。
#define STATUS_ARRIVED_MASK 0x0000000000000400
#define STATUS_ARRIVED 0x0000000000000400
#define STATUS_NOT_ARRIVED 0x0000000000000000

/// 系统若已经到达了目标点，则系统就需要进行一次扫描，扫描周围目标点的可达性。以下为扫描是否完成，若完成就应该进行下一次的目标点选择。
#define STATUS_SCAN_MASK 0x0000000000000800
#define STATUS_SCAN 0x0000000000000800
#define STATUS_NOT_SCAN 0x0000000000000000

/// 系统是否已经完成了一次目标点的选择，若已经完成，则需要复位前面几个状态位，然后等待系统前往下一个目标点
#define STATUS_TARGET_SELECTED_MASK 0x0000000000001000
#define STATUS_TARGET_SELECTED 0x0000000000001000
#define STATUS_NOT_TARGET_SELECTED 0x0000000000000000

/// 系统是否已经寻找到迷宫中的宝藏点。
#define STATUS_FIND_TREASURE_MASK 0x0000000000002000
#define STATUS_FIND_TREASURE 0x0000000000002000
#define STATUS_NOT_FIND_TREASURE 0x0000000000000000

/// 若系统已经寻找到宝藏，则就需要寻找出口。此时前面的目标点选择标识位失效
#define STATUS_FIND_EXIT_MASK 0x0000000000004000
#define STATUS_FIND_EXIT 0x0000000000004000
#define STATUS_NOT_FIND_EXIT 0x0000000000000000

/// 系统是否已经到达出口。
#define STATUS_ARRIVED_EXIT_MASK 0x0000000000008000
#define STATUS_ARRIVED_EXIT 0x0000000000008000
#define STATUS_NOT_ARRIVED_EXIT 0x0000000000000000

/// 若系统已经到达出口，则发送一份完整的地图到上位机。
#define STATUS_SEND_MAP_MASK 0x0000000000010000
#define STATUS_SEND_MAP 0x0000000000010000
#define STATUS_NOT_SEND_MAP 0x0000000000000000

/// 系统是否正在转弯。在转弯时，距离传感器的数据不可靠，因此需要关闭距离传感器。
#define STATUS_TURNING_MASK 0x0000000000020000
#define STATUS_TURNING 0x0000000000020000
#define STATUS_NOT_TURNING 0x0000000000000000

#endif //SEARCHCAR_STATUS_H
